<!DOCTYPE html>
<html>
    <link rel="shortcut icon" type="image/jpg" href="https://raw.githubusercontent.com/ajskateboarder/stuff/main/more/logo.png">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <script src="https://cdn.rawgit.com/adriancooney/console.image/c9e6d4fd/console.image.min.js"></script>
    <body style="background-color: #303030; color: white;" onload="check()">
        <title>Login</title>
                    <div class="topnav">
                &nbsp;&nbsp;&nbsp;<a class="active" href="/"><img src="https://raw.githubusercontent.com/ajskateboarder/stuff/main/more/logo.png" width="25"></a>
                <a href="https://github.com/themysticsavages/scratchhh.tk" target="blank">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GitHub</a>
                <a href="/whyus">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Why us?</a>
                <div style="text-align:right; float:right; right:0">
                  <a href="/backpack" id="backpack" hidden>Backpack</a>
                <a href="/login" id="text">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Login&nbsp;&nbsp;&nbsp;</a>
            </div>
            </div><br>
        <div align='center'>
        <br>
        <h1 style="margin: 10px;">Welcome!</h1>
        <hr class="header">
        We store your logins as cookies on YOUR browser, not with us.<br><br>
        <label style="margin-left: 10px;">Enter your username: </label> <input class="box dark" id="user" type="text" autocomplete="off"> <br>
        <label style="margin-left: 10px;">and it's password: </label> <input class="box dark" id="pass" type="password" autocomplete="off"> <br>
        <button id="submit" style="margin-left: 10px;" class="dark" onclick="sendCredits()">&nbsp;Login&nbsp;</button> <br>
        <br><p class="err" id="error"></p>
        </div>
    </body>
</html>
<style type="text/css">
        .dark { color: white; background-color: #404040; border: none; outline: none; }
        .dark:hover { color: white; background-color: #505050; }
        .header { height:2px; color: #808080; background-color: #808080; left: 0; width: 98.5% }
        .box { background-color: #404040; color: white; border: none; }
        .err { margin-left: 10px; color: #d22b2b }
        .topnav { background-color: rgba(0, 0, 0); top: 0; opacity: 0.5; position: fixed; text-align: left;overflow: hidden; left: 0; width: 100%; display: inline-block; }
        .topnav a { display: inline-block; color: #f2f2f2; opacity: 0.5; text-align:left; text-decoration: none; font-size: 17px; height: 30px;}
        .topnav a:hover { background: #000; color: #FFF; opacity: 2; }
</style>
<script>
function setCookie(e, t, n) {
    const o = new Date;
    o.setTime(o.getTime() + 24 * n * 60 * 60 * 1e3);
    let i = "expires=" + o.toGMTString();
    document.cookie = e + "=" + t + ";" + i + ";path=/"
}

function getCookie(e) {
    let t = e + "=",
        n = decodeURIComponent(document.cookie).split(";");
    for (let e = 0; e < n.length; e++) {
        let o = n[e];
        for (;
            " " == o.charAt(0);) o = o.substring(1);
        if (0 == o.indexOf(t)) return o.substring(t.length, o.length)
    }
    return ""
}

var Base64 = {
    _keyStr: "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",
    encode: function(e) {
        var t = "";
        var n, r, i, s, o, u, a;
        var f = 0;
        e = Base64._utf8_encode(e);
        while (f < e.length) {
            n = e.charCodeAt(f++);
            r = e.charCodeAt(f++);
            i = e.charCodeAt(f++);
            s = n >> 2;
            o = (n & 3) << 4 | r >> 4;
            u = (r & 15) << 2 | i >> 6;
            a = i & 63;
            if (isNaN(r)) {
                u = a = 64
            } else if (isNaN(i)) {
                a = 64
            }
            t = t + this._keyStr.charAt(s) + this._keyStr.charAt(o) + this._keyStr.charAt(u) + this._keyStr.charAt(a)
        }
        return t
    },
    decode: function(e) {
        var t = "";
        var n, r, i;
        var s, o, u, a;
        var f = 0;
        e = e.replace(/[^A-Za-z0-9\+\/\=]/g, "");
        while (f < e.length) {
            s = this._keyStr.indexOf(e.charAt(f++));
            o = this._keyStr.indexOf(e.charAt(f++));
            u = this._keyStr.indexOf(e.charAt(f++));
            a = this._keyStr.indexOf(e.charAt(f++));
            n = s << 2 | o >> 4;
            r = (o & 15) << 4 | u >> 2;
            i = (u & 3) << 6 | a;
            t = t + String.fromCharCode(n);
            if (u != 64) {
                t = t + String.fromCharCode(r)
            }
            if (a != 64) {
                t = t + String.fromCharCode(i)
            }
        }
        t = Base64._utf8_decode(t);
        return t
    },
    _utf8_encode: function(e) {
        e = e.replace(/\r\n/g, "\n");
        var t = "";
        for (var n = 0; n < e.length; n++) {
            var r = e.charCodeAt(n);
            if (r < 128) {
                t += String.fromCharCode(r)
            } else if (r > 127 && r < 2048) {
                t += String.fromCharCode(r >> 6 | 192);
                t += String.fromCharCode(r & 63 | 128)
            } else {
                t += String.fromCharCode(r >> 12 | 224);
                t += String.fromCharCode(r >> 6 & 63 | 128);
                t += String.fromCharCode(r & 63 | 128)
            }
        }
        return t
    },
    _utf8_decode: function(e) {
        var t = "";
        var n = 0;
        var r = c1 = c2 = 0;
        while (n < e.length) {
            r = e.charCodeAt(n);
            if (r < 128) {
                t += String.fromCharCode(r);
                n++
            } else if (r > 191 && r < 224) {
                c2 = e.charCodeAt(n + 1);
                t += String.fromCharCode((r & 31) << 6 | c2 & 63);
                n += 2
            } else {
                c2 = e.charCodeAt(n + 1);
                c3 = e.charCodeAt(n + 2);
                t += String.fromCharCode((r & 15) << 12 | (c2 & 63) << 6 | c3 & 63);
                n += 3
            }
        }
        return t
    }
};
function check() {
    if (getCookie('username') && getCookie('password')) window.location.href = '/'
}

async function sendCredits() {
    let e = document.getElementById("user").value,
        t = document.getElementById("pass").value;
    if (!e || !t) { return document.getElementById('error').innerText = 'Missing values' } else { document.getElementById('error').innerText = '' }
    var status = 0

    await fetch('https://scratchapinc.herokuapp.com/users/'+e+'/').then(res => res.json()).then(res => {
      if (res['message']) { document.getElementById('error').innerText = 'No such user'; return status = 1; }
    })
    await fetch(`https://scratchapinc.herokuapp.com/correctcredits/?user=${e}&pass=${t}`).then(res => res.json()).then(res => {
        if (res['status'] == 'False') { document.getElementById('error').innerText = 'Incorrect password'; return status = 1; }})

    if (status == 0) { setCookie('username', Base64.encode(e));setCookie('password', Base64.encode(t));window.location.href = '/' }
}
window.onload = async function() {
  console.image('https://static.wikia.nocookie.net/musicmania/images/9/96/CF61BEEE-66D0-4E77-A6D8-2DE75A6E2DBB.jpeg')
}
</script>
